vrrp_script chk_haproxy {           # Requires keepalived-1.1.13
        script "<%= keepalived_script %>"     # cheaper than pidof
        interval <%= keepalived_interval %>                      # check every 2 seconds
        weight <%= keepalived_weight %>                        # add 2 points of prio if OK
}

vrrp_instance VI_1 {
        interface <%= keepalived_interface %>
        state <%= keepalived_state %>
        virtual_router_id <%= keepalived_virtual_router_id %>
        priority <%= keepalived_priority %>
        virtual_ipaddress {
            <%= keepalived_virtual_ipaddress %>
        }
        track_script {
            chk_haproxy
        }
}